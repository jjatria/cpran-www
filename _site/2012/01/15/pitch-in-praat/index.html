
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>JJA | Pitch in Praat</title>
  <meta name="description" content="">
  <meta name="author" content="José Joaquín Atria">

  <!-- Enable responsive viewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="/assets/themes/rodriguez/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/assets/themes/rodriguez/bootstrap/css/bs-sticky-footer.css" rel="stylesheet">

  <!-- Custom styles -->
  <link href="/assets/themes/rodriguez/css/style.css" rel="stylesheet" type="text/css" media="all">
  <link href="/assets/themes/rodriguez/css/linkbar.css" rel="stylesheet" type="text/css" media="all">
  

  <style>
    .fleuron {
      min-height: 50px;
      background: #fff url(/assets/themes/rodriguez/images/fleuron.svg) no-repeat scroll center;
      border: none;
      display: block;
    }
    .fleuron hr {
      display: none;
    }
  </style>

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <link rel="shortcut icon" href="/assets/themes/rodriguez/images/favicon.ico">
  <!-- Update these with your own images
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

  <!-- atom & rss feed -->
  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
  <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

</head>

<body>
<div id="wrap">
<div id="banner"><a href="/">JJA</a></div>


<link href="/assets/themes/rodriguez/css/post.css" rel="stylesheet" type="text/css" media="all">

<nav id="linkbar">
  <div id="topbar">
  <ul>
      
      
      


  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
        
          <li><a href="/blog/index.html">Blog</a></li>
        
      
    
  
    
      
        
          <li><a href="/scripts/index.html">Scripts</a></li>
        
      
    
  
    
      
        
          <li><a href="/tutorials/index.html">Tutorials</a></li>
        
      
    
  
    
      
        
          <li><a href="/research/index.html">Research</a></li>
        
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  




  </ul>
  </div>
</nav>

<div class="content h-entry">

<ul class="pagination inline-list">

  <li class="prev disabled"><a>&larr; Previous</a></li>

  <li><a href="/archive.html">Archive</a></li>

  <li class="next"><a href="/2013/06/20/continuum-synthesis-with-tandemstraight" title="Continuum synthesis with TandemSTRAIGHT">Next &raquo;</a></li>

</ul>

<div class="page-header">
  <h1 class="p-name">Pitch in Praat</h1> <small>A brief explanation of Praat's pitch detection algorithm</small>
</div>

<div class="date">
  Posted by <a href="http://pinguinorodriguez.cl" class="p-author h-card">JJA</a> on <time class="dt-published" datetime="2012-01-15 00:00:00 +0000">15 January 2012</time>
</div>
<div class="content e-content">
  
<aside class="rem">
  <p>This page uses SVG files for the figures, so that they don’t lose detail when
being resized. If your browser does not support SVG files, a PNG file should be
available as a fallback. If you have any trouble viewing the figures, I would
appreciate if you could drop me a line.</p>
</aside>

<p>The analysis of periodic curves is best suited when working with continuous,
stable curves. However, the sounds of speech are nothing if not unstable, which
makes analysis more difficult. Praat overcomes this by assuming that speech is
sufficiently stable when looking at small enough fragments of it, which are
called  ‘windows of analysis’.</p>

<p>This is the sound we’ll be working on: a complex sound wave with a fundamental
frequency of 140Hz and a harmonic of 280Hz.</p>

<figure>
 <figcaption>The sound in the analysis window</figcaption>
 <object data="/assets/tutorials/praat_pitch/figures/fig1.svg">
  <img src="/assets/tutorials/praat_pitch/figures/fig1.png" alt="Three cycles of a complex sine wave, with a peak amplitude of 1 and
  starting and ending at 0. The horizontal axis is 945 samples long" />
 </object>
</figure>

<p>Each window is filtered to make sure there are no intensity peaks on the edges,
which facilitates analysis. The filter used in this demonstration is a Hanning
window (<a href="#boersma1993">Boersma, 1993</a>). According to the
Praat documentation, a Hanning window is more responsive when working with 3
periods per analysis window, while a Gaussian window is better when working with
a larger analysis window (the Gaussian window is twice as large as the Hanning
window).</p>

<p>Praat indeed uses both these windows as default depending on the task and the
degree of precision that is required.</p>

<figure>
 <figcaption>The Hanning filter function</figcaption>
 <object data="/assets/tutorials/praat_pitch/figures/fig2.svg">
  <img src="/assets/tutorials/praat_pitch/figures/fig2.png" alt="A Hanning filter, tracing a bell curve asymptotically approaching 0 on
  both ends" />
 </object>
</figure>

<p>We apply the filter by multiplying both curves.</p>

<figure>
 <figcaption>The filtered window</figcaption>
 <object data="/assets/tutorials/praat_pitch/figures/fig3.svg">
  <img src="/assets/tutorials/praat_pitch/figures/fig3.png" alt="A Hanning-filtered complex sine wave, with an amplitude close to 0 on
  each end and 1 in the middle" />
 </object>
</figure>

<p>To detect a sound’s pitch Praat uses autocorrelation, comparing each window with
itself.</p>

<p>An autocorrelation plot shows the degree to which the compared curves are
related on the Y-axis, and the time lag for each comparison on the X-axis. If
the curve is periodic, then there should be a peak on the autocorrelation curve
when the lag is equal to the original curve’s period.</p>

<p>The autocorrelation is highest at a time lag of 0, so we need to look for peaks
that are greater than 0 for significant periodicity. However, in this case,
since we are working with a complex sound wave with a loud harmonic, the
autocorrelation curve shows a false peak (red line) before the time lag that we
know is the sound’s actual fundamental frequency (blue line), which is alligned
with a lower peak.</p>

<figure>
 <figcaption>Normalized autocorrelation of the filtered sound</figcaption>
 <object data="/assets/tutorials/praat_pitch/figures/fig4.svg">
  <img src="/assets/tutorials/praat_pitch/figures/fig4.png" alt="An autocorrelation function, showing a series of peaks with decreasing
  size. A red line marks the top of the second (on sample 157), and a blue line
  marks the top of the third (on sample 316), which is lower. The fourth peak,
  roughly half-way through the curve, is the last 1 that is plain to see" />
 </object>
</figure>

<p>In order to correct for this, we need to divide the filtered signal by the
normalized autocorrelation curve of the windowing function.</p>

<figure>
 <figcaption>Normalized autocorrelation of the window function</figcaption>
 <object data="/assets/tutorials/praat_pitch/figures/fig5.svg">
  <img src="/assets/tutorials/praat_pitch/figures/fig5.png" alt="Half of a bell curve, starting from 1 and curving downwards to the right,
  asymptotically approaching 0 in the end" />
 </object>
</figure>

<p>The result is an estimate of the autocorrelation of the original signal, which
is both robust and better suited for the analysis of speech signals than
previous methods used. Note that this estimate gets increasingly unreliable
after roughly half the length of the analysis window
(<a href="#boersma1993">Boersma, 1993</a>).</p>

<figure>
 <figcaption>Estimated autocorrelation of the original signal</figcaption>
 <object data="/assets/tutorials/praat_pitch/figures/fig6.svg">
  <img src="/assets/tutorials/praat_pitch/figures/fig6.png" alt="Three cycles of a sinusoid wave, half the length of the ones shown
  before, starting on a peak at a magnitude of 1. The second peak is slightly
  lower than the first. The third peak, which is slightly higher than the
  second, is marked with a blue line on sample 316" />
 </object>
</figure>

<p>And by finding the maximum at a time lag &gt; 0 in this estimated curve, we can
calculate the pitch of the original signal converting from samples to Hz.</p>

<script type="math/tex; mode=display"> f_0 = \frac{1}{lag_{max} / f_s} </script>

<noscript>
  <pre><code>f_0 = 1 / (lag / f_s)
</code></pre>
</noscript>

<p><strong>Update</strong> (2015/10/03): This page, which was originally written as notes to
myself, is by far the most popular page in this site. So I feel obligated to
clarify that this article covers only one improvement that can be done to the
use of the autocorrelation function for pitch detection. More robust algorithms,
such as the one actually implemented in Praat, make use of other corrections,
such as pathfinding to ignore sudden changes in f0 that are impossible for the
human vocal tract.</p>

<aside class="rem">
  <p>All figures in this page were generated with <a href="http://www.r-project.org/">R</a> with the commands that can be
found in <a href="/assets/tutorials/praat_pitch/scripts/figures.R">this file</a>.
Feel free to look at the definitions of each curve and to modify it for your own
ends.</p>
</aside>

<hr />

<h2 id="references">References</h2>

<ul>
  <li id="boersma1993" class="reference">Boersma, P. (1993) <a href="http://www.fon.hum.uva.nl/paul/papers/Proceedings_1993.pdf">Acurate short-term analysis of the fundamental frequency
  and the harmonics-to-noise ratio of a sampled sound.</a> IFA
  Proceedings 17: 97-110</li>
</ul>


</div>




<ul class="tag_box inline-list">
  
  


  
     
    	<li class="tag"><a href="/tags.html#tutorial" rel="tag">tutorial <span>3</span></a></li>
     
    	<li class="tag"><a href="/tags.html#praat" rel="tag">praat <span>3</span></a></li>
    
  



</ul>


<ul class="pagination inline-list">

  <li class="prev disabled"><a>&larr; Previous</a></li>

  <li><a href="/archive.html">Archive</a></li>

  <li class="next"><a href="/2013/06/20/continuum-synthesis-with-tandemstraight" title="Continuum synthesis with TandemSTRAIGHT">Next &raquo;</a></li>

</ul>


</div>



<div class='fleuron'><hr /></div>

</div>

  <div id="footer">
    <div class="container">
      <p>&copy; 2015 JJA |
        Built with <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
      </p>
    </div>
  </div>

  




  <!-- Latest compiled and minified JavaScript, requires jQuery 1.x (2.x not supported in IE8) -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="/assets/themes/rodriguez/bootstrap/js/bootstrap.min.js"></script>
  
    
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
  
</body>
</html>

